<h1>Criteria API를 이용한 query</h1>

<h2>Criteria API</h2>

* JPQL이 문자열을 이용하여 작성하는 query라면, Criteria API는 Java 코드를 이용해서 작성하는 query 이다. 아래 코드는 `CriteriaQuery`를   
  이용하여 query를 작성한 예시이다.
```java
CriteriaBuilder builder = entityManager.getCriteriaBuilder();
CriteriaQuery<User> query = builder.createQuery(User.class);

Root<User> root = query.from(User.class);
query.select(root);
query.where(builder.equal(root.get("name"), "이름"));

TypedQuery<User> typedQuery = entityManager.createQuery(query);
List<User> users = typedQuery.getResultList();
```

* 위 코드는 `SELECT u FROM User u WHERE u.name = '이름'`에 해당하는 query를 생성하는 criteria 코드이다.
* Criteria를 이용해서 query를 작성하는 것은 복잡하지만, 다양한 조건을 조합하기 쉽고, java code를 사용하기에 타입에 안전한 query를   
  만들 수 있다는 장점 때문에 사용한다.
<hr/>

<h2>Criteria 기본 코드</h2>

* Criteria 코드의 기본 구조는 아래와 같다.
```java
// (1) EntityManager에서 CriteriaBuilder 객체 구하기
CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();

// (2) CriteriaQuery 객체 생성, 결과 타입으로 User 사용
CriteriaQuery<User> criteriaQuery = criteriaBuilder.createQuery(User.class);

// (3) SQL문 : "FROM User u"
Root<User> root = criteriaQuery.from(User.class);

// (4) SQL문 : "SELECT u FROM User u"
criteriaQuery.select(root);

// (5) CriteriaQuery로부터 Query 생성
TypedQuery<User> query = entityManager.createQuery(criteriaQuery);
```

* Criteria를 사용할 때는 먼저 `EntityManager#getCriteriaBuilder()`로 `CriteriaBuilder`객체를 구한다. 이 객체는 `CriteriaQuery`를   
  생성할 때 사용된다.

* `CriteriaBuilder#createQuery()` 메소드로 `CriteriaQuery`객체를 생성한다. 이 메소드의 인자로는 조회 결과 타입을 지정한다.

* `javax.persistence.criteria.CriteriaQuery`는 `from()`, `select()`, `where()` 등 query를 구성하기 위한 메소드를 제공한다.   
  이들은 각가 JPQL의 FROM, SELECT, WHERE절에 대응한다.

* `from()` 메소드는 JPQL의 FROM절에 대응하는 메소드로, 검색 대상이 되는 entity의 타입을 인자로 받는다.   
  `javax.persistence.criteria.Root`는 `from()`으로 선택한 Entity 대상이다. 위 코드에서 root는 `User` Entity를 의미하는 `Root`가 된다.

* `CriteriaQuery#select()` 메소드는 SELECT결과로 선택할 대상을 지정한다. `from()`에서 지정한 Entity를 SELECT의 결과로 사용하려면   
  `from()`으로 구한 `Root`객체를 `select()`메소드에 전달한다.

* 원하는 대로 `CriteriaQuery`를 구성했다면, `EntityManager#createQuery(CriteriaQuery)`메소드를 이용해서 `TypedQuery`객체를 생성하고   
  실행하면 된다.
<hr/>

<h2>검색 조건 지정</h2>

