<h1>테스트 범위와 종류</h1>

<h2>테스트 범위</h2>

* 일반적인 웹 애플리케이션에서 하나의 기능이 올바르게 동작하려면 컨트롤러, 서비스, 모델과 같은 Java 코드와 프레임워크 설정에   
  문제가 없어야 할 뿐 아니라 브라우저에서 실행되는 JS코드, HTML, CSS 등이 정상 동작해야 한다.   
  또한 DB의 테이블도 올바르게 생성되어 있어야 한다.

* 개발자가 코드를 조금씩 수정할 때마다 브라우저에서 DB까지의 전 범위를 테스트해야 하는 것은 아미녀,   
  출시 전에 DB와 연동할 때 사용한 query만 확인해서도 안된다. 테스트의 범위는 테스트의 목적과 수행하는 시점에 따라 달라진다.

* 웹 애플리케이션의 경우, 테스트 범위에 따른 테스트 종류는 아래와 같다.
  * 단위 테스트 : Java 코드 내의 서비스, 모델만 테스트
  * 통합 테스트 : Java 코드(+WAS) + DB까지의 테스트
  * 기능 테스트 : 브라우저 + Java 코드(+WAS) + DB 까지의 총 테스트

<h3>기능 테스트와 E2E 테스트</h3>

* 기능 테스트(Functional Testing)는 사용자 입장에서 시스템이 제공하는 기능이 올바르게 동작하는지를 확인한다.   
  이 테스트를 수행하려면 시스템을 구동하고 사용하는데 필요한 모든 구성 요소가 필요하다.   
  예를 들어 회원 가입 기능의 작동을 확인하려면 웹 서버, DB, 웹 브라우저가 필요하다.

* 기능 테스트는 사용자가 직접 사용하는 웹 브라우저나 모바일 앱부터 시작해서 DB나 외부 서비스에 이르기까지의   
  모든 구성 요소를 하나로 엮어서 진행한다. 이는 끝(브라우저)에서 다른 끝(DB)까지 모든 구성 요소를 논리적으로   
  완전한 하나의 기능으로 다룬다. 기능 테스트는 끝에서 끝까지 올바른지 검사하기 때문에 E2E(End-To-End) 테스트로도 볼 수 있다.

* QA 로직에서 수행하는 테스트가 주로 기능 테스트이다. 이때 테스트는 시스템이 필요로하는 데이터를 입력하고 결과가 올바른지 확인한다.

<h3>통합 테스트</h3>

* 통합 테스트(Integration Testing)는 시스템의 각 구성 요소가 올바르게 연동되는지를 확인한다.   
  기능 테스트가 사용자 입장에서 테스트하는 데 반해 통합 테스트는 소프트웨어의 코드를 직접 테스트한다.

* 일반적인 웹 애플리케이션은 프레임워크, 라이브러리, DB, 그리고 구현한 코드가 주요 통합 테스트 대상이다.   
  Spring Framework, JPA, MariaDB를 이용해서 회원 가입 관련된 서비스 클래스, DAO 인터페이스, SQL 쿼리를 구현했다면   
  이들을 통합한 회원 가입 서비스에 대한 테스트가 통합 테스트의 예시가 될 수 있다.   
  통합 테스트를 수행하면 Spring Framework 등의 프레임워크 설정이 올바른지, Query가 맞는지, DB Transaction이 잘   
  동작하는지 등을 검증할 수 있다.

<h3>단위 테스트</h3>

* 단위 테스트(Unit Test)는 개별 코드나 컴포넌트가 기대한대로 동작하는지 확인한다. 지금까지 예시로 든 것들이 모두 이에 해당한다.   
  단위 테스트는 한 클래스나 한 메소드와 같은 작은 범위를 테스트한다. 일부 의존 대상은 stub이나 모의 객체 등을 이용해 대역으로 대체한다.

<h3>테스트 범위 간 차이</h3>

* 각 테스트는 아래와 같은 차이가 있다.

  * 통합 테스트를 실행하려면 DB나 캐시 서버와 같은 연동 대상을 구성해야 한다. 기능 테스트를 실행하려면 웹 서버를 구동하거나   
    모바일 앱을 핸드폰에 설치해야할 수도 있다. 또한, 통합 테스트나 기능 테스트는 테스트 상황을 만들어내기 위해 많은 노력이   
    필요하다. 반면에 단위 테스트는 테스트 코드를 빼면 따로 준비해야할 것이 없다.

  * 통합 테스트는 DB 연결, 소켓 통신, 스프링 컨테이너 초기화와 같이 테스트 실행 속도를 느리게 만드는 요인이 많다.   
    기능 테스트는 추가로 브라우저나 앱을 구동하고 화면의 흐름에 따라 알맞은 상호 작용을 해야한다.   
    반면에 단위 테스트는 서버를 구동하거나 DB를 준비할 필요가 없다. 테스트 대상이 의존하는 기능을 대역으로 처리하면 되므로   
    테스트의 실행 속도가 빠르다.

  * 통합 테스트나 기능 테스트로는 상황을 준비하거나 결과 확인이 어렵거나 불가능할 때가 있다.   
    외부 시스템과 연동해야하는 기능이 특히 그렇다. 이런 경우에는 단위 테스트와 대역을 조합해서 상황을 만들고 결과를 확인해야 한다.

* TDD를 하는지의 여부에 관계없이 테스트 코드를 작성하는 개발자는 단위 테스트와 통합 테스트를 섞어서 작성한다.   
  어떤 테스트를 더 많이 작성해야 한다는 절대적인 규칙은 없지만, 위와 같은 차이로 통합 테스트 코드 보다는    
  단위 테스트 코드를 더 많이 작성한다.

* 통합 테스트를 실행하려면 준비할 것이 많고 단위 테스트에 비해 실행 시간도 길지만, 그래도 통합 테스트는 필요하다.   
  아무리 단위 테스트를 많이 만든다고 해도 결국은 각 구성 요소가 올바르게 연동되는 것을 확인해야 하는데   
  이를 자동화하기 좋은 수단이 통합 테스트 코드이기 때문이다.

<h3>테스트 범위에 따른 테스트 코드 개수와 시간</h3>

* 기능 테스트, 통합 테스트, 단위 테스트 등 전 범위에 대해 테스트를 자동화하려고 하는 시도가 증가하고 있다.   
  테스트를 자동화하는 만큼 고품질의 소프트웨어를 더 빠르게 출시할 수 있기 때문이다.   
  테스트를 자동화한다는 것은 결국 코드로 작성한 테스트를 실행한다는 것을 의미한다.

* 기능 테스트를 수행하려면 브라우저와 모바일 앱과 같은 클라이언트부터 DB까지 모든 환경이 갖춰져야 하기에 자동화하거나   
  상황별로 테스트하기 가장 어렵다. 이런 이유로 정기적으로 수행하는 기능 테스트는 정상적인 경우와 몇 가지 특수한 상황만   
  테스트 범위로 잡는다. 기능 테스트를 수행하기 위한 알맞은 도구가 없으면 기능 테스트 코드를 만들기 힘들 수도 있다.

* 통합 테스트는 기능 테스트에 비해 제약이 덜하다. 또한, 시스템의 내부 구성 요소에 대한 테스트도 가능하다.   
  통합 테스트는 기능 테스트에 비해 상대적으로 실행 시간이 짧고 상황을 보다 유연하게 구성할 수 있기 때문에 보통   
  기능 테스트보다 통합 테스트를 더 많이 작성한다.

* 단위 테스트는 통합 테스트로도 만들기 힘든 상황을 쉽게 구성할 수 있다. 더 작은 단위를 대상으로 테스트 코드를 만들고   
  더 다양한 상황을 다루기 때문에 통합 테스트보다 단위 테스트 코드를 더 많이 작성하게 된다.

* 기능 테스트나 통합 테스트에서 모든 예외 상화을 테스트하면 단위 테스트는 줄어든다. 왜냐면 각 테스트가 다루는 내용이   
  중복되기 때문이다. 예를 들어 회원 가입 기능 통합 테스트에서 중복 ID에 대한 테스트를 다루면 회원 가입 기능에 대한   
  단위 테스트에서는 중복 ID에 대한 테스트를 중복해서 작성할 필요가 없다.

* 하지만 테스트 속도는 통합 테스트보다 단위 테스트가 빠르기 때문에 가능하면 단위 테스트에서 다양한 상황을 다루고,   
  통합 테스트나 기능 테스트는 주요 상황에 초점을 맞춰야 한다. 그래야 테스트 실행 시간이 증가해 피드백이 느려지는 것을   
  방지할 수 있다. 테스트 실행 속도가 느려지면 테스트를 작성하지 않거나 테스트 실행을 생략하는 상황이 벌어진다.   
  이는 결국 소프트웨어의 품질 저하로 이어질 수 있기에 가능하면 빠른 시간 내에 테스트를 진행할 수 있도록 해야한다.
<hr/>

