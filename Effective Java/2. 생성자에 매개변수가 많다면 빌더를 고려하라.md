# 생성자에 매개변수가 많다면 빌더를 고려하라

- 정적 팩토리와 생성자에는 똑같은 제약이 하나 있는데, 바로 **선택적 매개변수가 많을 때 대응하기 어렵다는 것**이다.  
  학생의 정보를 담는 클래스를 생각해보자. 학생의 정보를 담으려면 굉장히 많은 속성을 가져야 하는데, 그 중에서도 추려서  
  아래의 클래스가 나왔다고 하자. 이런 클래스용 생성자 혹은 정적 팩토리는 어떤 모습일까?

- 개발자들은 이럴 때 점층적 생성자 패턴(Telescoping Constructor Pattern)을 즐겨 사용했다.  
  필수 매개변수만 받는 생성자, 필수와 선택을 1개 받는 생성자, 선택을 2개까지 받는 생성자 등의 형태로  
  선택 배개변수를 전부 다 받는 생성자까지 늘려나가는 방식이다. 아래는 예시이다.

```java
public class Student {
	private final int age;  // 필수
	private final String gender;  // 선택
	private final String school;  // 선택
	private final String city;  // 선택
	private final String name;  // 필수

	public Student(int age, String name) {
		this.age = age;
		this.name = name;
	}

	public Student(int age, String name, String gender) {
		this.age = age;
		this.name = name;
		this.gender = gender;
	}

	// ...

	public Student(int age, String gender, String school, String city, String name) {
		this.age = age;
		this.gender = gender;
		this.school = school;
		this.city = city;
		this.name = name;
	}
}
```

- 이 클래스의 인스턴스를 만들려면 원하는 매개변수를 모두 포함한 생성자 중 가장 짧은 것을 호출하면 된다.

```java
Student student = new Student(24, "Male", "Some School", "Seoul", "Sangwoo");
```

- 보통 이런 생성자는 사용자가 설정하고 싶지 않은 매개변수까지 포함하기 쉬운데,  
  어쩔 수 없이 그런 매개변수에도 값을 지정해줘야 한다. 앞 코드에서는 school에 어쩔 수 없이  
  "Some School"을 넘겨주었다. 위 예시에서는 그래봤자 매개변수가 5개라 그리 나빠보이지 않을 수 있지만,  
  매개변수의 숫자가 늘어나면 금세 걷잡을 수 없게 된다.

- 즉, **점층적 생성자 패턴도 쓸 수는 있지만, 매개변수 개수가 많아지면 클라이언트 코드를**  
  **작성하거나 읽기 어렵다.** 코드를 읽을 때 각 값의 의미가 무엇인지 헷갈릴 것이고,  
  매개변수가 몇개인지도 주의해서 세어보아야 할 것이다. 타입이 같은 매개변수가 연달아 늘어서 있으면  
  찾기 어려운 버그로 이어질 수 있다. 클라이언트가 실수로 매개변수의 실수를 바꿔 건네줘도 컴파일러는 알아채지 못하고,  
  결국 런타임에 엉뚱한 동작을 하게 될 것이다.

<hr/>

- 이번에는 선택적 매개변수가 많을 때 활용할 수 있는 두 번째 대안인 JavaBeans Pattern을 살펴보자.  
  이 패턴은 매개변수가 없는 생성자로 객체를 만든 후, Setter 메소드들을 호출해 원하는 매개변수의 값을  
  설정해주는 방식이다.

```java
public class Student {
	private int age = 0;  // 필수
	private String gender = "";  // 선택
	private String school = "";  // 선택
	private String city = "";  // 선택
	private String name = "";  // 필수

	// Standard Setters
}
```

- 이 패턴의 단점은 **객채 하나를 만들려면 메소드를 여러 개 호출해야 하고, 객체가 완전히 생성되기 전까지는**  
  **일관성(Consistency)이 무너진 상태에 놓기에 된다는 것** 이다. 오히려 점층적 생성자 패턴에서는 매개변수들이  
  유효한지를 생성자에서만 확인하면 일관성을 유지할 수 있었는데, 그 장치가 완전히 사라진 것이다.  
  일관성이 깨진 객체가 만들어지면, 버그를 심은 코드와 그 버그 때문에 런타임에 문제를 겪는 코드가 물리적으로 멀리  
  떨어져있을 것이므로 디버깅도 만만치 않다. 이처럼 일관성이 무너지는 문제 때문에 **JavaBeans 패턴에서는 클래스를**  
  **불변으로 만들 수 없으며** thread 안정성을 얻으려면 프로그래머가 추가적인 작업을 해줘야만 한다.

<hr/>
