# API 진화 반영

- 지금까지 작성한 JSON 반환 API 작성은 어렵지 않았다. 그보다는 Reactor Flow에  
  적응하는 것이 훨씬 어려웠다. API 문서화 등은 swagger를 사옹하면 쉽게 할 수 있다.  
  하지만 앞으로 마주하게 될 가장 큰 난관은 API 구현이나 문서화가 아니다.  
  바로 **API가 진화한다**는 점이다.

- 개발자에게 변경이란 피할 수 없는 숙명이다. 이미 배포된 API를 변경하면 API 사용자는  
  예전처럼 API를 사용할 수 있을까? 여러 버전으로 제공하면 해결될까? 아니면 API에 변경  
  사항이 생길 때마다 구 버전 호환성을 항상 고민해야 하는 것일까?

> API 변경 시 API 사용자에게 추가로 소모되는 비용은 개발자에게는 그리 크게 와닿지 않을  
> 수도 있다. API 사용자에게 아무런 즉각적인 비즈니스 가치도 만들어주지 못하는 변경은  
> 기존 API에 변경이 없을 것이라고 예상한 API 사용자에게 단순히 비용이 아니라 프로젝트 계획의  
> 붕괴, 예산 초과 등으로 이어질 수 있는 큰 위험이라는 점을 이해하는 것이 핵심이다.
>
> - Jean-Jacques Dubray, Understanding the Costs of Versioning

- 인용한 위 논문에서 저자는 세 가지 API 변경 유형을 설명한다.

  - 매듭(knot): 모든 API 사용자가 단 하나의 버전에 묶여 있다. API가 변경되면 모든 사용자도  
    함께 변경을 반영해야 하므로 엄청난 여파를 몰고 온다.
  - 점대점(Point-To-Point): 사용자마다 별도의 API 서버를 통해 API를 제공한다.  
    사용자별로 적절한 시점에 API를 변경할 수 있다.
  - 호환성 버저닝(Compatible Versioning): 모든 사용자가 호환 가능한 하나의 API 서비스  
    버전을 사용한다.

- 위 3가지 API 유형을 바탕으로 진행한 연구 결과를 보자.  
  이 연구는 API변경 유형과 각각의 변경에 필요한 비용을 계산했다.  
  우선 매듭(knot) 방식의 비용은 변경이 많아질수록(새로운 버전이 나올 수록) 비용이  
  급속도로 증가한다. 변경의 양이 적더라도 그 영향은 엄청나다. API 사용자는 변경된  
  API에 포함된 기능을 사용하든, 사용하지 않든 무조건 강제적으로 업그레이드해야 한다.

- 점대점(Point-to-Point) 방식은 매듭 방식에 비해서는 상당히 많은 비용을 줄일 수 있지만  
  여전히 적지 않은 비용이 소모되고 증가 속도 또한 가파르다. 이 방식에서는 API 사용자에게  
  미치는 영향은 줄어들지만, 여러 버전을 유지하고 관리해야 하므로 서버 개발팀의 비용이 증가한다.

- 마지막으로 호환성(Compatible Versioning) 방식은 비용 규모도 적고 증가 속도도 완만하다.  
  동일한 API에 대해 기존 사용자도 그대로 사용할 수 있고, 새로 추가된 기능도 사용할 수 있게  
  해주므로 API 사용자는 자신의 상황에 맞춰 가장 적합할 때 업그레이드하면 된다.  
  서버 개발팀도 여러 버전을 관리해야할 필요가 없으므로 부담이 적다.

- 그렇다면 하위 호환성을 유지하는 호환성 방식의 서비스는 어떻게 만들 수 있을까?  
  바로 **하이퍼미디어**를 적용해서 만들 수 있다.

<hr/>
