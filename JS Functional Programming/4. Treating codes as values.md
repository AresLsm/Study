# 코드를 값으로 다루어 표현력 높이기

- 함수형 프로그래밍에서는 코드를 값으로 다루는 아이디어를 많이 사용한다.  
  이를 통해 어떤 함수가 코드인 함수를 받아서 평가하는 시점을 원하는대로 다룰 수 있기에  
  코드의 표현력을 상당히 높일 수 있다.

```js
const products = [
  { name: "apple", price: 100 },
  { name: "banana", price: 200 },
  { name: "orange", price: 300 },
  { name: "strawberry", price: 400 },
];

const add = (a, b) => a + b;

reduce(
  add,
  map(
    (p) => p.price,
    filter((p) => p.price < 200, products)
  )
);
```

- 위 코드는 함수가 그렇게 많이 중첩되어 있지는 않지만 가독성이 떨어지는 느낌을 받는다.  
  위 코드를 조금 더 가독성이 좋게 변경해보자.

<hr/>

<h2>go, pipe</h2>

<h3>go</h3>

```js
const go = () => {};

// 아래는 go 함수의 사용 예시이다.
go(
  0,
  (a) => a + 1,
  (a) => a + 10,
  (a) => a + 100,
  console.log
); // 111
```

- 위 `go()` 함수는 인자들을 받아 하나의 값으로 축약해 나가는 함수이다.  
  이는 `reduce()`와 동일하다.  
  이제 구현해보자.

```js
const go = (...args) => reduce((a, fn) => fn(a), args);
```

<h3>pipe</h3>

- `pipe()` 함수는 `go()`와는 달리 함수를 반환하는 함수이다.  
  `go()`는 값과 함수들을 인자로 받아 결과값을 바로 평가하는데에 사용한다면,  
  `pipe()`는 함수들이 나열되어 있는 합성된 함수를 만들어 반환하는 함수이다.

```js
// pipe 함수 사용 예시
const f = pipe(
  (a) => a + 1,
  (a) => a + 10,
  (a) => a + 100
);
```

- 위 코드에서 `pipe()`는 3개의 함수를 받아 축약된 함수를 반환한다. 바로 구현해보자.

```js
const pipe =
  (...fns) =>
  (arg) =>
    go(a, ...fns);

console.log(f(0)); // 111
```

- `go()`는 두 수를 더해주는 `add()` 함수가 있을 때, 이 함수를 첫번째 인자로 전달할 수도 있다.

```js
const add = (a, b) => a + b;

go(
  add(0, 1),
  (a) => a + 10,
  (a) => a + 100
);

console.log(go()); // 111
```

- 위처럼 `pipe()`도 첫 번째 인자로 들어오는 함수는 2개의 인자를 받도록 해줘보자.

```js
const pipe =
  (f, ...fns) =>
  (...args) =>
    go(f(...args), ...fns);
```
