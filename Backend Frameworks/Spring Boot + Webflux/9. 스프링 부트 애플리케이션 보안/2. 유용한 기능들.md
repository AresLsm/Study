## 사용자 컨텍스트 접근

- 보안 관리 기능을 추가한다는 것은 **현재 사용자의 세부정보에 접근할 수 있다는 점**에서  
  또다른 중요한 의미를 갖는다.

- 사용자별로 다른 리소스를 보여줘야 할 때, 로그인한 사용자의 세부 정보에 접근할 수 있으므로  
  쉽게 처리할 수 있다. 예를 들어, 아래 코드처럼 구현할 수 있다.

```kt
@GetMapping
fun home(auth: Authentication): Mono<Rendering> {
    return Mono.just(Rendering.view("home.html")
        .modelAttribute("items", inventoryService.getInventory())
	.modelAttribute("cart", inventoryService.getCart(cartName(auth))
	    .defaultIfEmpty(Cart(cartName(auth))))
	.modelAttribute("auth", auth)
	.build())
}
```

- 위 코드처럼 컨트롤러 레벨에 `Authentication`을 메소드 인자로 추가하면 Spring Security가  
  **구독자 컨텍스트(Subscriber Context)** 에서 `Authentication` 정보를 추출해서  
  인자로 주입해준다.

- `Authentication` 정보를 활용하기 전에, 위 코드에서 사용한 `cartName()` 메소드를 보자.

```kt
class Controller {
    //..
    companion object {
	private fun cartName(auth: Authentication): String {
	    return "${auth.name}'s cart"
	}
    }
}
```

- 이렇게 컨트롤러 메소드에서 사용자 컨텍스트에 접근하기 위해 인자로 `Authentication`을 넘겨준 뒤에  
  할 일은 **메소드 수준의 보안 적용**이다.

<hr/>
