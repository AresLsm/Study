# 고차 함수 정의

- 고차 함수는 다른 함수를 인자로 받거나 함수를 반환하는 함수다. 코틀린에서는 람다나 함수 참조를 사용해  
  함수를 값으로 표현할 수 있다. 따라서 고차 함수는 람다나 함수 참조를 인자로 넘길 수 있거나, 람다나 함수  
  참조를 반환하는 함수다. 물론 함수를 인자로 받는 동시에 함수를 반환하는 함수도 고차 함수이다.  
  예를 들어, 표준 라이브러리 함수인 `filter()`는 술어 함수를 인자로 받으므로 고차 함수다.

```kt
list.filter { x > 0 }
```

- 이런 고차 함수를 정의하려면 **함수 타입(Function Type)** 에 대해 먼저 알아야 한다.

## 함수 타입

- 람다를 인자로 받는 함수를 정의하려면 먼저 람다 인자의 타입을 어떻게 선언할 수 있는지 알아야 한다. 인자 타입을 정의하기  
  전에 더 단순한 경우로 람다를 로컬 변수에 대입하는 경우를 살펴보자.

```kt
val sum = { x: Int, y: Int -> x + y }
val action = { println(42) }
```

- 이 경우 컴파일러는 sum과 action이 함수 타입임을 추론한다.  
  이제는 각 변수에 구체적인 타입 선언을 추가하면 어떻게 되는지 보자.

```kt
val sum: (Int, Int) -> Int = { x, y -> x + y }
val action: () -> Unit = { println(42) }
```

- 위처럼 함수 타입을 정의하려면 함수 파라미터의 타입을 괄호 안에 넣고, 그 뒤에 `->`를 추가한 다음, 함수의 반환 타입을 지정하면 된다.

- `Unit`은 이전에 봤듯이 의미 있는 값을 반환하지 않는 함수 반환 타입에 쓰는 특별한 타입이다. 그냥 함수를 정의한다면  
  함수의 파라미터 목록 뒤에 오는 `Unit` 반환 타입 지정을 생략해도 되겠지만, 함수 타입을 선언할 때는 반환 타입을 반드시  
  명시해야 하므로 `Unit`을 빼먹으면 안된다.

- 이렇게 변수 타입을 함수 타입으로 지정하면, 함수 타입에 있는 파라미터로부터 람다식의 파라미터 타입을 유추할 수 있다.  
  따라서 람다 식 안에서 굳이 파라미터 타입을 적을 필요가 없다. 그래서 `{ x, y -> x + y}` 처럼 x와 y의  
  타입을 생략해도 된다.

- 다른 함수와 마찬가지로 함수 타입에서도 반환 타입을 nullable한 타입으로 지정할 수 있다.

```kt
val canReturnNull: (Int, Int) -> Int? = { x, y -> null }
```

- 물론 nullable한 함수 타입 변수를 정의할 수도 있다. 다만 함수의 반환 타입이 아니라 함수 타입 전체가 nullable함을  
  선언하기 위해 함수 타입을 괄호로 감싸고, 그 뒤에 물음표를 붙여야만 한다.

```kt
var funOrNull: ((Int, Int) -> Int)? = null
```

- `canReturnNull()`의 타입과 `funOrNull()`의 타입 사이에는 큰 차이가 있다는 사실에 유의하자.

> **파라미터명과 함수 타입**
>
> - 함수 타입에서 파라미터명을 지정할 수도 있다.
>
> ```kt
> fun performRequest(
>     url: String,
>     callback: (code: Int, content: String) -> Unit
> ) {
>     // ...
> }
>
> // client
> val url = "https://kotlinlang.org"
> performRequest(url) { code, content -> /* ... */ }
> performRequest(url) { code, page -> /* ... */ } // 원하는 이름을 붙여도 되긴 한다.
> ```
>
> - 파라미터명은 타입 검사 시 무시된다. 함수 타입의 람다를 정의할 때, 파라미터명이 꼭 함수 타입 선언의 파라미터명과  
>   일치하지 않아도 된다. 하지만 함수 타입에 인자 이름을 추가하면 코드 가독성이 좋아지고, IDE의 자동완성 기능을 사용할 수 있다.

<hr/>
