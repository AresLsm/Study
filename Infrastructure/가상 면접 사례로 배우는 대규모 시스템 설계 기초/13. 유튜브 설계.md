# Youtube 설계

## 문제 이해 및 설계 범위 확정

- 유튜브에서는 단순히 비디오를 보는 것 말고도 많은 일을 할 수 있다. 댓글 남기기, 비디고 공유 및 좋아요 버튼 클릭, 재생 목록에 추가,  
  채널 구독 등도 할 수 있다. 이 모두를 설계하는 것은 사실상 불가능하니, 설계 범위를 좁혀보자.

- 비디오를 올리는 기능, 시청하는 기능에 집중한다.
- 모바일 웹, 웹 브라우저, 스마트 TV를 지원한다.
- DAU는 500만이다.
- 사용자는 평균적으로 30분동안 서비스를 사용한다.
- 다국어 지원이 가능해야 한다.
- 현존하는 비디오 종류와 해상도를 대부분 지원해야 한다.
- 암호화가 필요하다.
- 비디오의 최대 크기는 1GB이다.
- 클라우드 서비스를 활용해도 좋다.

- 이번 장에서는 아래와 같은 기능을 갖춘 비디오 스트리밍 서비스 설계에 초점을 맞출 것이다.

  - 빠른 비디오 업로드
  - 원활한 비디오 재생
  - 재생 품질 선택 기능
  - 낮은 인프라 비용
  - 높은 가용성과 규모 확장성, 그리고 안정성
  - 지원 클라이언트: 모바일 웹, 웹 브라우저, 스마트 TV

### 개략적 규모 추정

- DAU: 500만 명
- 한 사용자는 하루에 평균 5개의 비디오 시청
- 10%의 사용자는 하루에 1개의 비디오 업로드
- 비디오의 평균 크기는 300MB(0.3GB)
- 비디오 저장을 위해 매일 새로 요구되는 저장 용량 = `500만 * 10% * 300MB = 150TB`
- CDN 비용
  - 클라우드 CDN을 통해 비디오를 서비스할 경우 CDN에서 나가는 데이터량에 비례해 과금된다.
  - AWS CloudFront를 사용할 경우 100%의 트래픽이 미국에서 발생한다 가정하면 1GB당 $0.02의 요금이 발생한다.
  - 따라서 매일 발생하는 요금은 `500만 * 5개 비디오 * 0.3GB * $0.02 = $150,000`이다.

---
