# 안정 해시 설계

- 수평적 규모 확장성을 달성하기 위해서는 요청 또는 데이터를 서버에 균등하게 나누는 것이 중요하다.  
  이를 달성하기 위해서는 보편적으로 **안정 해시**를 사용한다.

## 안정 해시가 풀어주는 기술적 문제들

### 해시 키 재배치(rehash) 문제

- N개의 캐시 서버가 있다고 해보자. 이 서버들에 부하를 균등하게 나누는 보편적인 방법은 아래의 해시 함수를 사용하는 것이다.

```c
serverIndex = hash(key) % N // N: Server 개수
```

- 예시로 4개의 서버를 사용한다 해보자. 아래는 실제 상황에 대한 예시 표이다.

| Key  | Hash     | Hash % 4 (Server Index) |
| ---- | -------- | ----------------------- |
| key0 | 18358617 | 1                       |
| key1 | 26143584 | 0                       |
| key2 | 18131146 | 2                       |
| key3 | 35864496 | 0                       |
| key4 | 34085809 | 1                       |
| key5 | 27581703 | 3                       |
| key6 | 38164978 | 2                       |
| key7 | 22530351 | 3                       |
