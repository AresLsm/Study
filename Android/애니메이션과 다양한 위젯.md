애니메이션과 다양한 위젯의 사용
======

<h2>애니메이션 사용하기</h2>

* 안드로이드는 애니메이션을 간편하게 적용할 수 있는 여러가지 방법을 제공하는데, 그 중에서 `Tweened Animation`이   
  가장 간단하면서 일반적인 방법으로 사용된다. 이는 이동, 확대/축소, 회전과 같이 일정한 패턴으로 움직이는 애니메이션을   
  구현할 때 사용된다.

* 애니메이션이 어떻게 동작할지에 대한 정보는 XML로 만든다. 이렇게 만든 XML 정보는 자바 소스에서 `Animation`객체로   
  로딩한 후 View 객체의 `startAnimation()` 메소드를 사용해서 애니메이션을 동작하게 만들 수 있다.

* Tweened Animation의 Action정보는 XML 리소스로 정의하거나 소스코드에서 직접 객체로 만들 수 있다.   
  애니메이션을 위한 XML 파일은 `/app/res/anim` 폴더 하위에 두고, 확장자를 `*.xml`로 해야한다.   
  이렇게 리소스로 포함된 애니메이션 액션 정의는 다른 리소스와 마찬가지로 빌드할 때 컴파일되어 설치 파일에 포함된다.

* `/app/res` 하위에 anim 폴더를 만들고, 아래와 같이 `scale.xml` 파일을 추가하자.
```xml
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <scale
        android:duration="2500"
        android:pivotX="50%"
        android:pivotY="50%"
        android:fromXScale="1.0"
        android:fromYScale="1.0"
        android:toXScale="2.0"
        android:toYScale="2.0"
        />
</set>
```
* `<set>` 태그는 자동으로 만들어지며, 그 안에 `<scale>` 태그를 추가했다. 각각의 애니메이션이 액션이 갖는 공통적인 속성으로는   
  여러가지가 있지만 그중에서 대표적인 것이 __시작시간, 지속시간__ 이다. 시작 시간은 startOffset, 지속시간은 duration으로 지정한다.   
  startOffset은 애니메이션이 시작한지 얼마 후에 이 액션이 수행될 것인지를 알 수 있도록 한다. 이 값을 지정하지 않으면 애니메이션은   
  바로 시작된다. duration은 애니메이션이 지속되는 시간으로 ms 단위이며, 위 코드에서는 2.5초로 지정했다.

* `<scale>` 태그는 대상을 확대하거나 축소할 때 사용하는데, 크기를 변경하려는 축의 정보는 pivotX(X축), pivotY(Y축)로 지정한다.   
* fromXScale와 fromYScale은 시작할 때의 확대, 축소 비율이며 toXScale와 toYScale은 끝날 때의 확대, 축소 비율이다.   
  위 코드에서는 1.0으로 시작하여 2.0으로 끝나므로 원래 크기에서 시작해서 두배의 크기로 확대되는 애니메이션이 수행된다.

* `activity_main.xml`에 id가 button인 Button 객체가 있고, 이 객체에 대해 애니메이션을 수행해보자.
```java
public class MainActivity extends AppCompatActivity {
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button button = findViewById(R.id.button);
        
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Animation anim = AnimationUtils.loadAnimation(getApplicationContext(), R.anim.scale);
                view.startAnimation(anim);            }
        });
    }
}
```
* XML 리소스에 정의된 애니메이션 액션 정보를 로딩하기 위해 `AnimationUtils.loadAnimation()` 메소드를 사용한다.   
```java
public static Animation loadAnimation(Context context, int id);
```
* 이 코드를 바탕으로 app을 돌려보면 Button클릭 시 버튼이 2배 커지고 작아지는 모습을 볼 수 있는데, 작아지는 모습이 부자연스럽다.   
  애니메이션 수행 후 원상태로 자연스럽게 돌아가도록 만드는 가장 간단한 방법은 애니메이션이 끝난 후 똑같은 애니메이션을 거꾸로   
  적용하는 것이다. 즉, 두 개의 애니메이션이 연속으로 수행되도록 하나로 묶어주는 방법이다.
```xml
<!-- scale.xml -->
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <scale
        android:duration="2500"
        android:pivotX="50%"
        android:pivotY="50%"
        android:fromXScale="1.0"
        android:fromYScale="1.0"
        android:toXScale="2.0"
        android:toYScale="2.0"
        />
    
    <scale
        android:startOffset="2500"
        android:duration="2500"
        android:pivotX="50%"
        android:pivotY="50%"
        android:fromXScale="1.0"
        android:fromYScale="1.0"
        android:toXScale="0.5"
        android:toYScale="0.5" 
        />
</set>
```
* 위 코드에서 두번 째 `<scale>` 태그는 2.5초 후에 실행되고, 절반 줄어들도록 정의했으므로 버튼은 2.5초동안 2배로 확장된 후   
  바로 2.5초 동안 절반 크기로 줄어들 것이다.

<hr/>

<h3>Tweened Animation으로 위치 이동 액션 효과 주기</h3>

* 위치 이동은 대상의 위치를 변경하는 것으로, 한 곳에서 다른 곳으로 부드럽게 움직이는 효과를 낼 수 있다.   
  위치 이동 액션은 `<translate>` 태그를 사용하여 정의하는데, 시작 위치는 fromXDelta와 fromYDelta로 지정하고,   
  종료 위치는 toXDelta와 toYDelta 속성으로 지정한다. 다음은 대상의 크기만큼 왼쪽으로 이동시키는 액션을 XML로 정의한 것이다.
```xml
<translate xmlns:android:"http://schemas.android.com/api/res/android"
    android:fromXDelta="0%p"
    android:toXDelta="-100%p"
    android:duration="20000"
    android:repeatCount="-1"
    android:fllAfter="true" />
```
* 위 코드에서 fromXDelta 속성이 0%이므로 시작 위치의 X 좌표는 원래 위치의 X좌표가 된다. toXDelta 속성은 -100%이므로   
  대상의 크기만큼 왼쪽으로 이동하게 된다. 지속시간은 duration값이 20000이므로 20초가 되며, repeatCount가 -1이므로   
  무한 반복 된다. 애니메이션이 끝난 후 대상이 원래 위치로 돌아오는 것을 막기 위해서는 fillAfter 속성을 true로 지정하면 된다.
<hr/>

<h3>Tweened Animation으로 위치 회전 액션 효과 주기</h3>

* 회전은 한 점을 중심으로 대상을 회전시키는 효과를 만드는 액션으로, 시작 각도와 종료 각도를 지정할 수 있다.   
  예를 들어, 한 바퀴를 회전시키려고 한다면 fromDegrees 속성을 0으로 하고, toDegrees값을 360으로 지정하면 된다.   
  시계 반대 방향으로 회전시키고 싶을 경우에는 toDegrees 속성을 -360으로 지정하면 된다. 만약 대상의 중앙 부분을 회전의   
  중심으로 만들고 싶다면 pivotX와 pivotY의 값을 50%로 지정하면 된다. 회전은 `<rotate>` 태그를 사용하여 정의한다.
```xml
<rotate xmlns:android="http://schemas.android.com/apk/res/android"
    android:fromDegrees="0"
    android:toDegrees="360"
    android:pivotX="50%"
    android:pivotY="50%"
    android:duration="10000" />
```
<hr/>

<h3>Tweened Animation으로 투명도 액션 효과 주기</h3>

* 투명도를 결정하는 alpha값도 View나 Drawable 객체의 투명도를 점차적으로 바꿀 수 있는 애니메이션 액션으로 정의할 수 있다.   
  alpha값을 이용한 투명도 변환은 대상을 천천히 보이게 하거나, 보이지 않게 하고 싶을 때 또는 하나의 View위에 다른 View를   
  겹쳐 보이게 할 때 사용한다. alpha값의 범위는 0.0~1.0이며 0.0은 완전이 투명한 상태, 1.0은 완전히 불투명한 상태이다.   
  다음은 10초동안 대상을 천천히 보이게 만드는 액션을 XML로 정의한 것이다.
```xml
<alpha xmlns:android="http://schemas.android.com/apk/res/android"
    android:fromAlpha="0.0"
    android:toAlpha="1.0"
    android:duration="10000" />
```
<hr/>

<h3>Tweened Animation으로 속도 조절하기</h3>

* 애니메이션 효과가 지속되는 동안 빠르거나 느리게 효과가 진행되도록 만드는 방법은 `Interpolator`를 사용하면 된다.   
  Interpolator는 R.anim에 미리 정의된 정보를 사용해서 설정할 수 있는데, 아래는 대표적인 Interpolator들이다.

<table>
    <tr>
        <td>accelerate_interpolator</td>
        <td>애니메이션 효과를 점점 빠르게 나타나도록 만든다.</td>
    </tr>
    <tr>
        <td>decelerate_interpolator</td>
        <td>애니메이션 효과를 점점 느리게 나타나도록 만든다.</td>
    </tr>
    <tr>
        <td>accelerate_decelerate_interpolator</td>
        <td>애니메이션 효과를 점점 빠르다가 느리게 나타나도록 만든다.</td>
    </tr>
    <tr>
        <td>anticipate_interpolator</td>
        <td>애니메이션 효과를 시작 위치에서 조금 뒤로 당겼다가 시작하도록 만든다.</td>
    </tr>
    <tr>
        <td>overshoot_interpolator</td>
        <td>애니메이션 효과를 종료 위치에서 조금 지나쳤다가 종료되도록 만든다.</td>
    </tr>
    <tr>
        <td>anticipate_overshoot_interpolator</td>
        <td>바로 위 2개를 둘 다 수행하게 만든다.</td>
    </tr>
    <tr>
        <td>bounce_interpolator</td>
        <td>애니메이션 효과를 종료 위치에서 튀도록 만든다.</td>
    </tr>
</table>

* 이러한 정보들은 각각의 액션에 설정할 수도 있고, 애니메이션 집합에 설정할 수도 있다.   
  만약 각각의 액션이 다른 interpolator를 설정하는 경우에는 shareInterpolator속성을 false로 지정하면 된다.

* 이렇게 리소스로 정의된 애니메이션 정보들은 Java 코드에서 new 연산자로 직접 만들 수 도 있다. 
  * 위치 이동 : `<translate> ==> TranslateAnimation`
  * 회전 : `<rotate> ==> RotateAnimtation`
  * 확대/축소 : `<scale> ==> ScaleAnimation`
  * 투명도 : `<alpha> ==> AlphaAnimation`
  * 애니메이션 집합 : `<set> ==> AnimationSet`

* 애니메이션은 버튼이 눌려졌을 때와 같이 사용자에 의한 이벤트 발생으로 시작해야하는 경우도 있지만, 화면이 사용자에게   
  보이는 시점에서 시작해야하는 경우도 있다. 이러한 경우에 애니메이션의 시작점은 `onWindowFocusChanged()` 메소드가 호출되는 시점,   
  즉 윈도우가 사용자에 의해 포커스를 받는 시점이 되어야 한다. 따라서 `onWindowFocusChanged()` 메소드 내에서 파라미터로 전달되는   
  hasFocus 변수의 값이 true일 경우 각각의 애니메이션 객체에 대해 `start()` 메소드를 호출함으로써 애니메이션이 시작되도록 하면 된다.   
  윈도우가 다른 윈도우에 의해 가려지거나 할 때는 hasFocus값이 false가 되므로 이때는 애니메이션 객체의 `reset()` 메소드를 호출하여   
  초기 상태로 되돌릴 수 있다.

* 애니메이션이 언제 시작했는지 또는 끝났는지에 대한 정보는 `AnimationListener` 객체를 설정하면 알 수 있다. `Animation`객체에   
  리스너를 설정하면 애니메이션이 진행되는 상태에 따라 아래의 메소드들이 자동으로 호출된다.
```java
public void onAnimationStart(Animation animation); // 애니메이션이 시작되기 직전에 호출된다.
public void onAnimationEnd(Animation animation);  // 애니메이션이 끝났을 때 호출된다.
public void onAnimationRepeat(Animation animation);  // 애니메이션이 반복될 때 호출된다.
```
<hr/>

<h2>페이지 슬라이딩 사용하기</h2>

