# Proximity Service

- 이번 장에서는 proximity service를 설계해보자. Proximity service는 주로 음식점, 호텔, 영화관, 박물관 등 주변 장소들을  
  표현하는 데에 사용된다. 이런 proximity service는 주변에 있는 가장 좋은 음식점, 가장 가까운 주요소 등을 알려주는 데에 가장  
  큰 역할을 하는 컴포넌트가 된다.

## 문제 이해 및 설계 범위 확정

- Yelp의 proximity service는 가까운 장소들을 알려주는 것 외에도 많은 다양한 기능들을 제공한다.  
  따라서 이런 시스템 설게 인터뷰에서는 문제를 이해하고 설계 범위를 확실히 짚고 넘어가는 것이 좋다.

- 이번 장에서 설계할 proximity service의 요구사항은 아래와 같다.

  - 사용자의 위도, 경도 및 특정 반경 내의 모든 장소들을 알려준다.
  - 장소의 소유자들은 장소를 추가, 삭제 또는 갱신할 수 있으며 이러한 수정된 정보는 실시간으로 반영되지 않아도 된다.
  - 사용자들은 특정 장소에 대해 세부 정보를 알 수 있다.
  - DAU는 100M(100만) 이고 등록되어 있는 장소는 200M(200만) 개 이다.

- 위의 요구사항에 더불어, 아래의 추가적인 사항들도 적용해야 한다.

  - 낮은 latency: 사용자들은 주변 장소들을 빠르게 볼 수 있어야 한다.
  - Data privacy(데이터 안전성): 위치 정보는 꽤나 민감한 데이터이다. 따라서 LBS(Location-Based Service)를 설계할 때는 항상  
    사용자의 정보 보호를 위한 고민을 해야 한다. GDPR, CCPA 등 표준화된 데이터 보호 정책을 따르도록 해야 한다.
  - 높은 가용성(high availability)과 확장성(scalability): 시스템은 유명한 지역에서 트래픽이 치솟아도 서비스를 안정적으로 제공해야 한다.

- QPS를 계산하는 과정은 아래와 같다.

  - 하루는 총 `24 * 60 * 60 = 86400` 초이고, 이를 계산하기 쉽게 하기 위해 `10^5`로 나타내보자.
  - 사용자가 하루에 5번의 질의를 한다고 해보자.
  - 그러면 QPS는 `100M * 5 / 10^5 = 5000`이다.

---
