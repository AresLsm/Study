# 기민한 설계 / 개발 프로세스

- 마이크로서비스를 위한 가장 단순하고, 체계적이며, 효율적이면서도 기민한 반복적인 흐름을  
  반영한 개발 프로세스는 바로 **DDD를 활용한 스크럼 기반의 마이크로서비스 개발 프로세스**이다.  
  이 프로세스에서는 마이크로서비스를 개발하기 위한 핵심적인 설계 영역과 활동을 최소화하고  
  각 활동별로 최소한의 핵심 산출물을 정의한다.

<h2>점진/반복적인 스크럼 생명주기</h2>

- 기본 생명주기는 Scrum의 Sprint를 활용한다. 스프린트는 스크럼의 점진, 반복적인  
  생명주기이며 보통 1~4주 동안 진행된다. Backlog를 기반으로 각 스프린트의 task들이  
  배분되어 진행되며, 매 스프린트마다 실제로 동작하는 소프트웨어를 시연하고 피드백을 받는다.

- 스크럼의 주요 개념 및 공정을 간단히 살펴보자.

  - **Scrum Team**: 스프린트가 진행되는 팀을 뜻한다. 각 팀은 Scrum Master와 Team Member로 구성된다.  
    스크럼 팀은 다기능 팀으로서 Frontend. Backend, Architect, Tester, Design 등이 한 팀을 구성한다.  
    여러 직능을 가진 전문가들이 같은 팀에 모여있으므로 의사결정이 빠르고 협업이 긴밀하다. Scrum Master는 협업을  
    촉진하고 팀의 장애물을 제거하는 역할을 수행한다.
  - **Scrum Meeting**: 스크럼 팀은 매일 아침 짧게 진행되는 스탠드업 미팅을 통해 각자의 일을 투명하게 공유한다.
  - **계획 수립**: 시스템의 모든 요구사항은 백로그에 남기고, 그 다음 일정에 맞게 스프린트를 몇 번 수행할 것인가를  
    결정한다. 회수가 결정되면 백로그에 담긴 태스크들을 각 스프린트에 적절히 분배한다. 스프린트가 종료되면 백로그의  
    완료된 태스크들을 기준으로 팀의 생산성이 결정된다. 이를 소프트웨어 개발에서의 속도라고 한다. 이 속도에 맞춰  
    다음 스프린트의 계획이 세워지기에 매우 중요하다. 이러한 과정을 지속적인 계획(Continuous Planning)이라 하며,  
    기존의 고정(Fixed)된 계획이 아니라 적응적(Adaptive) 계획이라고 볼 수 있다.
  - **시연**: 스프린트의 마지막 활동은 시연과 회고다. 시연은 초기에 정의한 백로그 태스크가 모두 구현되고, 그 요건을  
    만족하는지를 확인하는 과정이다. 이때 피드백을 받을 수 있고, 다음 스프린트에 반영할 요건들을 확인할 수 있다.
  - **회고**: 팀원들이 자기 스스로를 돌아보는 시간으로, 설계 및 개발 과정에서 개선점을 논의한다.

<hr/>

<h2>아키텍쳐 정의와 마이크로서비스 도출</h2>

- 구현 스프린트를 본격적으로 진행하기 위해서는 준비하고 계획하는 활동이 필요하다.

<h3>아키텍쳐 정의</h3>

- 이 과정은 마이크로서비스의 외부/내부 아키텍쳐를 정의하는 과정이다. 소프트웨어의 유연성을 항상 유지해야한다는 점을  
  명심하되, 최소한의 개발 및 테스트 환경을 먼저 준비하는 것은 스프린트 진행에 매우 효과적이다.  
  그래야만 스프린트에서 실제로 돌아가는 애플리케이션을 시연해볼 수 있다. 최근의 클라우드 PaaS 개발 환경은  
  개발 환경 구축을 빠르게 진행할 수 있게 해준다. 언제든지 변경 가능하도록 구성하되 구현 기반은 마련해야 한다.  
  물론 이렇게 정의된 내부, 외부 아키텍쳐는 스프린트 과정을 통해 개선되고, 지속적으로 정제될 것이다.  
  아키텍쳐, 애플리케이션 구조가 유연하다면 언제든지 세부사항은 변경될 수 있기 때문이다.  
  구조 정의 시에는 꼭 변화에 염두를 두어 최대한 유연하게 정의한다.

<h3>마이크로서비스 도출</h3>

- 본격적으로 마이크로서비스 개발을 들어가기 위한 스크럼 팀이 전체 마이크로서비스들을 파악하는 작업이다.  
 모든 마이크로서비스를 하나의 스크럼 팀이 개발할 수 없으므로 DDD의 전략적 설계 기법을 활용해  
 마이크로서비스를 도출하고, 그들 간의 대략적인 매핑 관계를 정의한 후 마이크로서비스 개발 우선순위에 근거해  
 각 스크럼 팀에 분배해서 스프린트를 진행한다. 최종 결과물은 식별된 마이크로서비스들과 그들 간의 의존 관계를  
 나타내는 Context Map이다.
<hr/>

<h2>스프린트 내 개발 공정</h2>

<h3>백엔드 설계 및 개발</h3>

- 백엔드 설계의 시작은 API 설계이다. API 설계는 각 백엔드 마이크로서비스가 프론트엔드에 제공할 서비스의  
  명세이다. 초기에 API 설계를 진행해 프론트엔드 영역과 협의 및 조정해야 한다. 그래야만 프론트엔드 영역도  
  이를 기반으로 프론트엔드 자체의 설계를 진행할 수 있다. 다음으로 진행할 백엔드 영역의 설계는 정의된  
  마이크로서비스 내부 구조에 따라 도메인 모델과 데이터 모델을 설계하는 것이다.

- 예전의 설계 모델의 개념은 MDD(Model Driven Development)의 사례와 같이 추상적인 모델을 완벽히  
  만들어 놓고 특정 기술 프로파일이나 프레임워크를 적용해 구체적인 코드를 생성해서 모델과 코드가 단절되는  
  구조였다면, DDD의 모델링은 코드 자체가 모델의 기본 표현 형식을 그대로 반영해서 코드로 표현된다.  
  또한 개발 진행 중에 역공학 도구를 이용해 UML 모델로 시각화해서 볼 수 있기에, DDD의 모델은 항상  
  코드와 함께 숨쉬게 된다.

<h3>프론트엔드 설계와 개발</h3>

- 프론트엔드 영역의 설계는 UI Layout을 정의하고, 백엔드의 API를 호출해서 API가 보내준 데이터를 기반으로  
  UI에 어떻게 표현할 것인가를 정의하는 활동이다. 사용자가 접근하는 채널에 따라 모바일 앱, 웹 등의 다양한  
  레이아웃이 정의될 수 있고, 프론트 아키텍쳐에 따라 설계 수준 및 방식이 모두 다를 수 있다.  
  프론트엔드 영역 설계와 개발의 기본적인 활동은 아래와 같다.
  - **UI 흐름 정의**: 비즈니스 흐름에 따른 UI의 흐름을 정의한다. 이 결과물을 UI Story board라고도 한다.
  - **UI Layout 정의**: 사용자 접점인 UI를 정의하는 활동으로, 디자인을 고려하지 않은 사용자 경험을 고려해서  
    설계한다.
  - **UI 이벤트 및 액션 정의**: 사용자에 의해 발생하는 이벤트 및 액션을 정의하는 활동이다.
  - **UI 개발**: UI Layout 및 이벤트의 의도에 맞춰 실제 개발을 하는 활동이다. 보통 프론트엔드 아키텍쳐에서  
    정의한 UI 프레임워크나 도구를 사용할 수 있다.

<h3>빌드 및 배포</h3>

- 기민한 개발을 위해서는 백엔드와 프론트엔드의 개발이 진행되는 과정에서 지속적으로 빌드되고 자동으로 배포되도록  
  빌드 및 배포 환경을 자동화해야 한다. 스크럼 팀의 구성원은 언제라도 현재 진행된 만큼의 실제로 돌아가는 소프트웨어를  
  확인할 수 있어야 한다.

- DevOps 인프라 환경이 이를 지원하고, 백엔드 및 프론트엔드 개발자는 매일 통합 빌드되고 배포되는 개발 환경에  
  익숙해져야 한다. 따라서 빌드가 안되거나 배포가 안되는 상황을 방치해서는 안된다.

- 아키텍쳐를 정의할 때 빌드 및 배포 파이프라인이 구성된 상태에서 개발자의 입장에서 수행해야할 빌드 및 배포를 위한  
   활동들은 아래와 같다.
  - 코드 레포지토리 구성: 프론트엔드, 백엔드의 소스코드를 위한 레포지토리를 구성한다.
  - 통합 Build Job: 레포지토리에 존재하는 코드를 통합한 후 컴파일 및 테스트해서 바이너리를 만드는 활동을 자동화한다.
  - 컨테이너 생성 파일 작성: 배포 환경을 컨테이너로 구성할 경우 OS와 WAS와 build된 애플리케이션을 모두 묶어  
    컨테이너 이미지를 생성하는 스크립트를 작성한다. Docker Container의 경우엔 Dockerfile이다.
  - 배포 스크립트 작성: 자동으로 배포하는 스크립트를 작성한다. 배포 target에 맞춰 스크립트를 작성한다.

<hr/>
